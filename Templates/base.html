<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title or "Cerveza 0.0% Fresa & Mora" }}</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { brand:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b"} },
          boxShadow: { soft:"0 8px 24px rgba(0,0,0,.08)" }
        }
      },
      darkMode: 'class'
    }
  </script>
  <link rel="stylesheet" href="https://unpkg.com/@tabler/icons-webfont@latest/tabler-icons.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    .glass{background:rgba(255,255,255,.75);backdrop-filter:saturate(180%) blur(8px)}
    .dark .glass{background:rgba(17,24,39,.65)}
  </style>
  <script>(function(){const s=localStorage.getItem('theme');if(s==='dark'||(!s&&matchMedia('(prefers-color-scheme: dark)').matches)){document.documentElement.classList.add('dark')}})();</script>
</head>
<body class="h-full bg-gradient-to-br from-brand-50 via-teal-50 to-cyan-50 dark:from-slate-900 dark:via-slate-900 dark:to-slate-900 text-slate-800 dark:text-slate-100">
  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside class="hidden md:flex w-64 flex-col border-r border-white/60 dark:border-white/10 bg-white/70 dark:bg-slate-900/60 backdrop-blur">
      <div class="px-4 py-4 flex items-center gap-3">
        <i class="ti ti-beer text-2xl text-brand-600"></i>
        <div>
          <div class="font-bold leading-tight">Cerveza sin alcohol</div>
          <div class="text-xs text-slate-500 dark:text-slate-400">Fresa &amp; Mora · Panel</div>
        </div>
      </div>
      <nav class="mt-2 px-2 text-sm">
        <a href="{{ url_for('index') }}" class="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-brand-50 dark:hover:bg-slate-800 {% if request.endpoint=='index' %}bg-brand-50 dark:bg-slate-800{% endif %}"><i class="ti ti-home"></i> Inicio</a>
        <a href="{{ url_for('producto') }}" class="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-brand-50 dark:hover:bg-slate-800 {% if request.endpoint=='producto' %}bg-brand-50 dark:bg-slate-800{% endif %}"><i class="ti ti-beer"></i> Producto</a>
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('batches_list') }}" class="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-brand-50 dark:hover:bg-slate-800 {% if request.endpoint=='batches_list' %}bg-brand-50 dark:bg-slate-800{% endif %}"><i class="ti ti-barrel"></i> Lotes</a>
        {% endif %}
      </nav>
      <div class="mt-auto p-4 text-xs text-slate-500 dark:text-slate-400">
        &copy; {{ 2025 }} Fresa &amp; Mora · 0.0%
      </div>
    </aside>

    <!-- Main column -->
    <div class="flex-1 flex flex-col">
      <header class="glass border-b border-white/60 dark:border-white/10">
        <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between gap-3">
          <!-- Logos (usan tus nombres exactos) -->
          <div class="flex items-center gap-3">
            <img src="{{ url_for('static', filename='img/logo_udec.png') }}" onerror="this.style.display='none'" alt="Universidad de Cundinamarca" class="h-10 w-auto">
            <img src="{{ url_for('static', filename='img/logo_loja.png') }}" onerror="this.style.display='none'" alt="Universidad de Loja" class="h-10 w-auto">
          </div>

          <div class="flex items-center gap-2">
            <button id="themeToggle" class="inline-flex items-center justify-center w-9 h-9 rounded-lg hover:bg-white/60 dark:hover:bg-slate-800" title="Tema">
              <i class="ti ti-moon-stars dark:hidden"></i>
              <i class="ti ti-sun hidden dark:inline"></i>
            </button>
            {% if current_user.is_authenticated %}
              <span class="hidden sm:inline text-sm text-slate-600 dark:text-slate-300">Hola, {{ current_user.name }}</span>
              <form action="{{ url_for('logout') }}" method="post">
                <button class="px-3 py-1.5 rounded-lg bg-rose-600 text-white hover:bg-rose-700 text-sm"><i class="ti ti-logout-2"></i> Salir</button>
              </form>
            {% else %}
              <a href="{{ url_for('login') }}" class="px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 text-sm">Iniciar sesión</a>
              <a href="{{ url_for('register') }}" class="px-3 py-1.5 rounded-lg hover:bg-white/60 dark:hover:bg-slate-800 text-sm">Crear cuenta</a>
            {% endif %}
          </div>
        </div>
      </header>

      <!-- Flash -->
      <div class="max-w-7xl mx-auto px-4 mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="space-y-2">
              {% for category, message in messages %}
                <div class="rounded-xl px-4 py-3 text-sm shadow-soft
                        {% if category in ['success'] %} bg-emerald-100/80 text-emerald-900 dark:bg-emerald-900/50 dark:text-emerald-100
                        {% elif category in ['warning'] %} bg-amber-100/80 text-amber-900 dark:bg-amber-900/50 dark:text-amber-100
                        {% elif category in ['danger','error'] %} bg-rose-100/80 text-rose-900 dark:bg-rose-900/50 dark:text-rose-100
                        {% else %} bg-slate-100/80 text-slate-900 dark:bg-slate-800/70 dark:text-slate-100 {% endif %}">
                  {{ message }}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
      </div>

      <!-- CONTENT -->
      <main class="max-w-7xl mx-auto w-full px-4 py-6">
        {% block content %}{% endblock %}
      </main>
    </div>
  </div>

  <script>
    document.getElementById('themeToggle')?.addEventListener('click', () => {
      const cl = document.documentElement.classList;
      const isDark = cl.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
  </script>
</body>
</html>
