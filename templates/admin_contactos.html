{% extends "base.html" %}
{% block content %}
<section class="min-h-screen">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-extrabold">Bandeja de Contactos</h1>
    <a href="{{ url_for('admin_contactos_export') }}" class="px-3 py-2 rounded-lg border border-brand-400 hover:bg-brand-50 dark:border-gold-700 dark:hover:bg-ink-800 text-sm">
      Exportar CSV
    </a>
  </div>

  <div class="bg-white dark:bg-ink-900 rounded-2xl shadow-soft border border-brand-200/60 dark:border-ink-700 overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead class="bg-brand-100/40 dark:bg-ink-800/60">
        <tr class="text-left">
          <th class="px-4 py-3">#</th>
          <th class="px-4 py-3">Fecha</th>
          <th class="px-4 py-3">Nombre</th>
          <th class="px-4 py-3">Correo</th>
          <th class="px-4 py-3">Asunto</th>
          <th class="px-4 py-3">Mensaje</th>
          <th class="px-4 py-3">IP</th>
          <th class="px-4 py-3">Email?</th>
        </tr>
      </thead>
      <tbody>
        {% for m in msgs %}
        <tr class="border-t border-brand-200/40 dark:border-ink-700">
          <td class="px-4 py-3">{{ m.id }}</td>
          <td class="px-4 py-3 whitespace-nowrap">{{ m.created_at }}</td>
          <td class="px-4 py-3">{{ m.name }}</td>
          <td class="px-4 py-3">
            <a class="text-brand-700 dark:text-gold-300 underline" href="mailto:{{ m.email }}">{{ m.email }}</a>
          </td>
          <td class="px-4 py-3">{{ m.subject }}</td>
          <td class="px-4 py-3 max-w-[28rem]">
            <div class="line-clamp-3">{{ m.message }}</div>
          </td>
          <td class="px-4 py-3">{{ m.ip or "-" }}</td>
          <td class="px-4 py-3">
            {% if m.emailed %}<span class="px-2 py-0.5 rounded bg-green-100 text-green-800 text-xs">Sí</span>
            {% else %}<span class="px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 text-xs">Pendiente</span>{% endif %}
          </td>
        </tr>
        {% else %}
        <tr><td colspan="8" class="px-4 py-8 text-center text-brand-700/70 dark:text-gold-300/70">Sin mensajes aún.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
